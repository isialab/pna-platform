/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/@carbon/icon-helpers
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{r as t,x as e,_ as i}from"./lit-element-ljyXx2IF.js";import{n as o}from"./property-CoShOfqo.js";import{r as s}from"./state-D7rtIkB2.js";import{a as n}from"./query-BpyCOA3I.js";import{o as l}from"./query-assigned-elements-DvdLJjH_.js";import{p as a,s as r}from"./settings-BYFrjJ1N.js";import{i as c}from"./icon-loader-pxyCrZwZ.js";import{H as d}from"./host-listener-6VuJ4xzb.js";import{H as h}from"./host-listener-DJH6yN4y.js";import{c as p}from"./carbon-element-sn5DFO1t.js";import{_ as u}from"./20-seUgpuwc.js";import"./button-CKgb4gp4.js";import"./button.min.js";import"./button-skeleton-CXiEp3M8.js";import"./icon-button.min.js";import"./layer.min.js";import"./icon-loader-utils-lPqg1iFP.js";import"./directive-CwtBJVHj.js";import"./unsafe-html-C26Gpb7O.js";import"./on-CsYzs_5y.js";import"./class-map-warKt-hW.js";import"./if-defined-zhGxRN9M.js";import"./focus-Bwk_lgHl.js";import"./tooltip-content-D25Rgp9z.js";import"./popover.min.js";import"./floating-controller-qGN47tO7.js";import"./tooltip.min.js";var _,v;!function(t){t.EXTRA_SMALL="xs",t.SMALL="sm",t.MEDIUM="md",t.LARGE="lg",t.EXTRA_EXTRA_LARGE="2xl"}(_||(_={})),function(t){t.RIGHT="right",t.LEFT="left"}(v||(v={}));var m={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M6.7 12.3L2.9 8.5 15 8.5 15 7.5 2.9 7.5 6.7 3.7 6 3 1 8 6 13z"}}],name:"arrow--left",size:16};const b=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINS,g=Node.DOCUMENT_POSITION_FOLLOWING|Node.DOCUMENT_POSITION_CONTAINED_BY,$=`${a}--side-panel`,y=`${a}--action-set`;function f(t,e){for(let e=t.length-1;e>=0;--e){const i=t[e];if(i.focus(),i.ownerDocument.activeElement===i)return!0}return!1}let S=class extends(h(t)){constructor(){super(...arguments),this._hObserveResize=null,this._launcher=null,this._doAnimateTitle=!0,this._isOpen=!1,this._containerScrollTop=-16,this._hasSubtitle=!1,this._hasSlug=!1,this._hasActionToolbar=!1,this._actionsCount=0,this._slugCloseSize="sm",this._handleBlur=async({target:t,relatedTarget:e})=>{var i;const{open:o,_startSentinelNode:s,_endSentinelNode:n}=this,l=t!==this&&this.contains(t),a=e!==this&&(this.contains(e)||(null===(i=this.shadowRoot)||void 0===i?void 0:i.contains(e))&&e!==s&&e!==n),{selectorTabbable:r}=this.constructor;if(o&&e&&l&&!a){const i=t.compareDocumentPosition(e);e===s||i&b?(await this.constructor._delay(),f(this.querySelectorAll(r))||e===this||this.focus()):(e===n||i&g)&&(await this.constructor._delay(),f(this.querySelectorAll(r))||this.focus())}},this._handleKeydown=({key:t,target:e})=>{"Esc"!==t&&"Escape"!==t||this._handleUserInitiatedClose(e)},this._reducedMotion="undefined"!=typeof window&&(null===window||void 0===window?void 0:window.matchMedia)?window.matchMedia("(prefers-reduced-motion: reduce)"):{matches:!0},this._adjustPageContent=()=>{var t,e;if(this.selectorPageContent){const i=document.querySelector(this.selectorPageContent);if(i){const o={marginInlineStart:"",marginInlineEnd:"",inlineSize:"",transition:this._reducedMotion.matches?"none":"all 240ms",transitionProperty:"margin-inline-start, margin-inline-end"};this.open&&(o.inlineSize="auto","left"===this.placement?o.marginInlineStart=`${null===(t=null==this?void 0:this._sidePanel)||void 0===t?void 0:t.offsetWidth}px`:o.marginInlineEnd=`${null===(e=null==this?void 0:this._sidePanel)||void 0===e?void 0:e.offsetWidth}px`),Object.keys(o).forEach((t=>{i.style[t]=o[t]}))}}},this._checkSetOpen=()=>{const{_sidePanel:t}=this;t&&this._isOpen?this._reducedMotion?this._isOpen=!1:t.addEventListener("transitionend",(()=>{this._isOpen=!1})):this._isOpen=this.open},this._checkUpdateIconButtonSizes=()=>{var t,e;const i=this.querySelector(`${a}-slug`),o=null===(t=null==this?void 0:this.shadowRoot)||void 0===t?void 0:t.querySelectorAll("#nav-back-button, #close-button");let s="sm";if(i||(null==o?void 0:o.length)){const t=null===(e=null==this?void 0:this.querySelectorAll)||void 0===e?void 0:e.call(this,`${a}-button[slot='actions']`);(null==t?void 0:t.length)&&/l/.test(this.size)&&(s="md")}i&&(null==i||i.setAttribute("size",s)),o&&[...o].forEach((t=>{t.setAttribute("size",s)}))},this._checkUpdateActionSizes=()=>{if(this._actions)for(let t=0;t<this._actions.length;t++)this._actions[t].setAttribute("size",this.condensedActions?"lg":"xl")},this._maxActions=3,this._checkSetDoAnimateTitle=()=>{var t,e,i;let o=!1;if(this._sidePanel&&this.open&&this.animateTitle&&(null===(t=null==this?void 0:this.title)||void 0===t?void 0:t.length)&&!this._reducedMotion.matches){const t=this._getScrollAnimationDistance();null===(i=null===(e=null==this?void 0:this._sidePanel)||void 0===e?void 0:e.style)||void 0===i||i.setProperty(`--${$}--scroll-animation-distance`,`${t}`);let s=this._animateScrollWrapper;if(s||!this.animateTitle||this._doAnimateTitle||(s=this._innerContent),s){const e=null===window||void 0===window?void 0:window.getComputedStyle(this._innerContent),i=e?parseFloat(null==e?void 0:e.paddingTop)+parseFloat(null==e?void 0:e.paddingBottom):0;o=(!!this.labelText||!!this._hasActionToolbar||this._hasSubtitle)&&s.scrollHeight-s.clientHeight>=t+i}}this._doAnimateTitle=o},this._resizeObserver=new ResizeObserver((()=>{this._sidePanel&&this._checkSetDoAnimateTitle()})),this._getScrollAnimationDistance=()=>{var t,e,i,o;return(null!==(e=null===(t=null==this?void 0:this._label)||void 0===t?void 0:t.offsetHeight)&&void 0!==e?e:0)+(null!==(o=null===(i=null==this?void 0:this._subtitle)||void 0===i?void 0:i.offsetHeight)&&void 0!==o?o:0)+(this._hasActionToolbar?this._title.offsetHeight-this._title.clientHeight:0)},this._scrollObserver=()=>{var t,e,i,o;const s=null!==(e=null===(t=this._animateScrollWrapper)||void 0===t?void 0:t.scrollTop)&&void 0!==e?e:0,n=this._getScrollAnimationDistance();null===(o=null===(i=null==this?void 0:this._sidePanel)||void 0===i?void 0:i.style)||void 0===o||o.setProperty(`--${$}--scroll-animation-progress`,""+Math.min(s,n)/n)},this._handleCurrentStepUpdate=()=>{var t;const e=null!==(t=this._animateScrollWrapper)&&void 0!==t?t:this._innerContent;e&&(e.scrollTop=0)},this.animateTitle=!0,this.closeIconDescription="Close",this.condensedActions=!1,this.includeOverlay=!1,this.navigationBackIconDescription="Back",this.open=!1,this.placement=v.RIGHT,this.preventCloseOnClickOutside=!1,this.selectorPageContent="",this.size=_.MEDIUM,this.slideIn=!1}_handleClickOnOverlay(t){this.preventCloseOnClickOutside||this._handleUserInitiatedClose(t.target)}_handleCloseClick(t){this._handleUserInitiatedClose(t.target)}_handleUserInitiatedClose(t){if(this.open){const e={bubbles:!0,cancelable:!0,composed:!0,detail:{triggeredBy:t}};this.dispatchEvent(new CustomEvent(this.constructor.eventBeforeClose,e))&&(this.open=!1,this.dispatchEvent(new CustomEvent(this.constructor.eventClose,e)))}}_handleNavigateBack(t){this.dispatchEvent(new CustomEvent(this.constructor.eventNavigateBack,{composed:!0,detail:{triggeredBy:t}}))}_handleSlugChange(t){this._checkUpdateIconButtonSizes();const e=t.target.assignedElements();this._hasSlug=e.length>0}_handleSubtitleChange(t){const e=t.target,i=null==e?void 0:e.assignedElements();this._hasSubtitle=i.length>0}_handleActionToolbarChange(t){const e=t.target,i=null==e?void 0:e.assignedElements();if(this._hasActionToolbar=i&&i.length>0,this._hasActionToolbar)for(const t of i)t.setAttribute("size","sm")}_handleActionsChange(t){var e;const i=t.target,o=null==i?void 0:i.assignedElements();this._checkUpdateIconButtonSizes();const s=null!==(e=null==o?void 0:o.length)&&void 0!==e?e:0;s>this._maxActions?(this._actionsCount=this._maxActions,"development"===production&&console.error(`Too many side-panel actions, max ${this._maxActions}.`)):this._actionsCount=s;for(let t=0;t<(null==o?void 0:o.length);t++)t+1>this._maxActions?(o[t].setAttribute("hidden","true"),o[t].setAttribute(`data-actions-limit-${this._maxActions}-exceeded`,`${o.length}`)):o[t].classList.add(`${y}__action-button`);this._checkUpdateActionSizes()}async connectObservers(){var t,e;await this.updateComplete,this._hObserveResize=(t=this._resizeObserver,(e=this._sidePanel)?(t.observe(e),{release:()=>(t.unobserve(e),null)}):null)}disconnectObservers(){this._hObserveResize&&(this._hObserveResize=this._hObserveResize.release())}connectedCallback(){super.connectedCallback(),this.disconnectObservers(),this.connectObservers()}disconnectedCallback(){super.disconnectedCallback(),this.disconnectObservers()}render(){const{closeIconDescription:t,condensedActions:i,currentStep:o,includeOverlay:s,labelText:n,navigationBackIconDescription:l,open:r,placement:d,size:h,slideIn:p,title:_}=this;if(!r&&!this._isOpen)return e``;const v=["","single","double","triple"][this._actionsCount],b=e`<div
      class=${`${$}__title`}
      ?no-label=${!!n}>
      <h2 class=${_?`${$}__title-text`:""} title=${_}>
        ${_}
      </h2>

      ${this._doAnimateTitle?e`<h2
            class=${`${$}__collapsed-title-text`}
            title=${_}
            aria-hidden="true">
            ${_}
          </h2>`:""}
    </div>`,g=this.title?` ${$}__header--has-title `:"",y=e`
      <div
        class=${`${$}__header${g}`}
        ?detail-step=${o>0}
        ?no-title-animation=${!this._doAnimateTitle}
        ?reduced-motion=${this._reducedMotion.matches}>
        <!-- render back button -->
        ${o>0?e`<cds-icon-button
              align="bottom-left"
              aria-label=${l}
              kind="ghost"
              size="sm"
              class=${`${a}--btn ${$}__navigation-back-button`}
              @click=${this._handleNavigateBack}>
              ${c(m,{slot:"icon"})}
              <span slot="tooltip-content">
                ${l}
              </span>
            </cds-icon-button>`:""}

        <!-- render title label -->
        ${(null==_?void 0:_.length)&&(null==n?void 0:n.length)?e` <p class=${`${$}__label-text`}>${n}</p>`:""}

        <!-- title -->
        ${_?b:""}

        <!-- render slug and close button area -->
        <div class=${`${$}__slug-and-close`}>
          <slot name="slug" @slotchange=${this._handleSlugChange}></slot>
          <!-- {normalizedSlug} -->
          <cds-icon-button
            align="bottom-right"
            aria-label=${t}
            kind="ghost"
            size="sm"
            class=${`${$}__close-button`}
            @click=${this._handleCloseClick}>
            ${c(u,{slot:"icon"})}
            <span slot="tooltip-content"> ${t} </span>
          </cds-icon-button>
        </div>

        <!-- render sub title -->
        <p
          class=${this._hasSubtitle?`${$}__subtitle-text`:""}
          ?hidden=${!this._hasSubtitle}
          ?no-title-animation=${!this._doAnimateTitle}
          ?no-action-toolbar=${!this._hasActionToolbar}
          ?no-title=${!_}>
          <slot
            name="subtitle"
            @slotchange=${this._handleSubtitleChange}></slot>
        </p>

        <div
          class=${this._hasActionToolbar?`${$}__action-toolbar`:""}
          ?hidden=${!this._hasActionToolbar}
          ?no-title-animation=${!this._doAnimateTitle}>
          <slot
            name="action-toolbar"
            @slotchange=${this._handleActionToolbarChange}></slot>
        </div>
      </div>
    `,f=e`<div
      class=${`${$}__inner-content`}
      ?scrolls=${!this._doAnimateTitle}>
      <cds-layer level="1">
        <slot></slot>
      </cds-layer>
    </div> `,S=this._doAnimateTitle?` ${$}--animated-title`:"";return e`
      <div
        class=${`${$}${S}`}
        part="dialog"
        role="complementary"
        placement="${d}"
        ?has-slug=${this._hasSlug}
        ?open=${this._isOpen}
        ?opening=${r&&!this._isOpen}
        ?closing=${!r&&this._isOpen}
        ?condensed-actions=${i}
        ?overlay=${s||p}
        ?slide-in=${p}
        size=${h}>
        <a
          id="start-sentinel"
          class="sentinel"
          hidden
          href="javascript:void 0"
          role="navigation"></a>

        ${this._doAnimateTitle?e`<div class=${`${$}__animated-scroll-wrapper`} scrolls>
              ${y} ${f}
            </div>`:e` ${y} ${f}`}

        <cds-button-set-base
          class=${`${$}__actions-container`}
          ?hidden=${0===this._actionsCount}
          ?condensed=${i}
          actions-multiple=${v}
          size=${h}>
          <slot name="actions" @slotchange=${this._handleActionsChange}></slot>
        </cds-button-set-base>

        <a
          id="end-sentinel"
          class="sentinel"
          hidden
          href="javascript:void 0"
          role="navigation"></a>
      </div>

      ${s?e`<div
            ?slide-in=${p}
            class=${`${$}__overlay`}
            ?open=${this.open}
            ?opening=${r&&!this._isOpen}
            ?closing=${!r&&this._isOpen}
            tabindex="-1"
            @click=${this._handleClickOnOverlay}></div>`:""}
    `}async updated(t){var e,i,o,s;if(t.has("condensedActions")&&this._checkUpdateActionSizes(),t.has("currentStep")&&this._handleCurrentStepUpdate(),t.has("_doAnimateTitle")&&(null===(e=null==this?void 0:this._animateScrollWrapper)||void 0===e||e.removeEventListener("scroll",this._scrollObserver),this._doAnimateTitle?null===(i=null==this?void 0:this._animateScrollWrapper)||void 0===i||i.addEventListener("scroll",this._scrollObserver):null===(s=null===(o=null==this?void 0:this._sidePanel)||void 0===o?void 0:o.style)||void 0===s||s.setProperty(`--${$}--scroll-animation-progress`,"0")),(t.has("_isOpen")||t.has("animateTitle"))&&this._checkSetDoAnimateTitle(),(t.has("slideIn")||t.has("open")||t.has("includeOverlay"))&&this._adjustPageContent(),t.has("open"))if(this._checkSetOpen(),this.disconnectObservers(),this.open){this.connectObservers(),this._launcher=this.ownerDocument.activeElement;const t=this.selectorInitialFocus&&this.querySelector(this.selectorInitialFocus);await this.constructor._delay(),t?t.focus():f(this.querySelectorAll(this.constructor.selectorTabbable))||this.focus()}else this._launcher&&"function"==typeof this._launcher.focus&&(this._launcher.focus(),this._launcher=null)}static _delay(t=0){return new Promise((e=>{setTimeout(e,t)}))}static get selectorTabbable(){return r}static get eventBeforeClose(){return`${a}-side-panel-beingclosed`}static get eventClose(){return`${a}-side-panel-closed`}static get eventNavigateBack(){return`${a}-side-panel-navigate-back`}};i([n("#start-sentinel")],S.prototype,"_startSentinelNode",void 0),i([n("#end-sentinel")],S.prototype,"_endSentinelNode",void 0),i([n(`.${$}`)],S.prototype,"_sidePanel",void 0),i([n(`.${$}__animated-scroll-wrapper`)],S.prototype,"_animateScrollWrapper",void 0),i([n(`.${$}__label-text`)],S.prototype,"_label",void 0),i([n(`.${$}__title-text`)],S.prototype,"_title",void 0),i([n(`.${$}__subtitle-text`)],S.prototype,"_subtitle",void 0),i([n(`.${$}__inner-content`)],S.prototype,"_innerContent",void 0),i([l({slot:"actions",selector:`${a}-button`})],S.prototype,"_actions",void 0),i([s()],S.prototype,"_doAnimateTitle",void 0),i([s()],S.prototype,"_isOpen",void 0),i([s()],S.prototype,"_containerScrollTop",void 0),i([s()],S.prototype,"_hasSubtitle",void 0),i([s()],S.prototype,"_hasSlug",void 0),i([s()],S.prototype,"_hasActionToolbar",void 0),i([s()],S.prototype,"_actionsCount",void 0),i([s()],S.prototype,"_slugCloseSize",void 0),i([d("shadowRoot:focusout")],S.prototype,"_handleBlur",void 0),i([d("document:keydown")],S.prototype,"_handleKeydown",void 0),i([o({reflect:!0,attribute:"animate-title",type:Boolean})],S.prototype,"animateTitle",void 0),i([o({reflect:!0,attribute:"close-icon-description"})],S.prototype,"closeIconDescription",void 0),i([o({type:Boolean,reflect:!0,attribute:"condensed-actions"})],S.prototype,"condensedActions",void 0),i([o({reflect:!0,attribute:"current-step",type:Number})],S.prototype,"currentStep",void 0),i([o({attribute:"include-overlay",type:Boolean,reflect:!0})],S.prototype,"includeOverlay",void 0),i([o({reflect:!0,attribute:"label-text"})],S.prototype,"labelText",void 0),i([o({reflect:!0,attribute:"navigation-back-icon-description"})],S.prototype,"navigationBackIconDescription",void 0),i([o({type:Boolean,reflect:!0})],S.prototype,"open",void 0),i([o({reflect:!0,type:String})],S.prototype,"placement",void 0),i([o({type:Boolean,attribute:"prevent-close-on-click-outside"})],S.prototype,"preventCloseOnClickOutside",void 0),i([o({reflect:!0,attribute:"selector-initial-focus",type:String})],S.prototype,"selectorInitialFocus",void 0),i([o({reflect:!0,attribute:"selector-page-content"})],S.prototype,"selectorPageContent",void 0),i([o({reflect:!0,type:String})],S.prototype,"size",void 0),i([o({attribute:"slide-in",type:Boolean,reflect:!0})],S.prototype,"slideIn",void 0),i([o({reflect:!1,type:String})],S.prototype,"title",void 0),S=i([p(`${a}-side-panel`)],S);
