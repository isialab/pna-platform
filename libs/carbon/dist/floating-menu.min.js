/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/@carbon/icon-helpers
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{r as e,_ as t}from"./lit-element-ljyXx2IF.js";import{H as s}from"./host-listener-6VuJ4xzb.js";import{F as i}from"./focus-Bwk_lgHl.js";import{H as o}from"./host-listener-DJH6yN4y.js";import{p as n}from"./settings-BYFrjJ1N.js";import"./on-CsYzs_5y.js";var r,a;!function(e){e.LTR="ltr",e.RTL="rtl"}(r||(r={})),function(e){e.TOP="top",e.BOTTOM="bottom"}(a||(a={}));const h=(e,t)=>(e.observe(t),{release:()=>(e.unobserve(t),null)}),p=(e,t)=>{const s=e.closest(t);if(s)return s;const{host:i}=e.getRootNode();return i?p(i,t):null};class l extends(o(i(e))){constructor(){super(...arguments),this._hObserveResizeParent=null,this._hObserveResizeContainer=null,this._resizeObserver=new ResizeObserver((()=>{const{container:e,open:t,parent:s,position:i}=this;if(e&&t&&s){const{direction:e,start:t,top:s}=i;this.style[e!==r.RTL?"left":"right"]=`${t}px`,this.style.top=`${s}px`}})),this._handleBlur=({relatedTarget:e})=>{if(!this.contains(e)){const{parent:t}=this;t&&t!==e&&(t.open=!1,HTMLElement.prototype.focus.call(this.parent))}},this._click=()=>{const{parent:e}=this;e&&(e.open=!1)},this._handleKeyDown=e=>{if("Tab"===e.key&&e.shiftKey){const{parent:e}=this;e&&(e.open=!1)}},this.parent=null}get container(){return p(this,this.constructor.selectorContainer)||this.ownerDocument.body}get position(){const{triggerPosition:e}=this.parent;if(!e)throw new TypeError("Missing information of trigger button position.");const{container:t}=this,{left:s=0,top:i=0,right:o=0}=e;let{bottom:n=0}=e;const{width:h,height:p}=this.getBoundingClientRect(),{left:l=0,right:c=0,top:d=0}=t.getBoundingClientRect();n-=d;const u=t.ownerDocument.defaultView.getComputedStyle(t),O=u.getPropertyValue("direction"),b=O===r.RTL,f=b?t.ownerDocument.defaultView.innerWidth-c:l,g=b?c-o:s-l,v=b?c-s:o-l,m=i-d;if((t!==this.ownerDocument.body||0!==f||0!==d)&&"static"===u.getPropertyValue("position"))throw new Error("Floating menu container must not have `position:static`.");const{flipped:R,direction:_}=this;if(Object.values(a).indexOf(_)<0)throw new Error(`Wrong menu position direction: ${_}`);const z=R?v-h:g,{start:w,top:y}={[a.TOP]:()=>({start:z,top:m-p}),[a.BOTTOM]:()=>({start:z,top:n})}[_]();return{direction:O,start:w,top:y}}disconnectedCallback(){this._hObserveResizeContainer&&(this._hObserveResizeContainer=this._hObserveResizeContainer.release()),this._hObserveResizeParent&&(this._hObserveResizeParent=this._hObserveResizeParent.release())}updated(e){var t;const{container:s,open:i,parent:o}=this;if((e.has("flipped")||e.has("direction")||e.has("open"))&&i){o||(this.parent=this.parentElement,s.appendChild(this));const{direction:e,start:t,top:i}=this.position;this.style[e!==r.RTL?"left":"right"]=`${t}px`,this.style.top=`${i}px`}if(e.has("open")&&(this._hObserveResizeContainer&&(this._hObserveResizeContainer=this._hObserveResizeContainer.release()),this._hObserveResizeParent&&(this._hObserveResizeParent=this._hObserveResizeParent.release()),i)){const{parentElement:e}=null!==(t=this.parent)&&void 0!==t?t:{};this._hObserveResizeContainer=h(this._resizeObserver,s),e&&(this._hObserveResizeParent=h(this._resizeObserver,e))}}static get selectorContainer(){return`[data-floating-menu-container],${n}-modal`}}l.FLOATING_MENU=!0,l.shadowRootOptions=Object.assign(Object.assign({},e.shadowRootOptions),{delegatesFocus:!0}),t([s("focusout")],l.prototype,"_handleBlur",void 0),t([s("click")],l.prototype,"_click",void 0),t([s("keydown")],l.prototype,"_handleKeyDown",void 0);export{l as C,a as F};
