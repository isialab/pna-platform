{"version":3,"file":"css-class-plugin.js","sources":["../../../src/components/date-picker/css-class-plugin.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2019, 2022\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Instance as FlatpickrInstance } from 'flatpickr/dist/types/instance';\nimport { Plugin } from 'flatpickr/dist/types/options';\nimport { forEach } from '../../globals/internal/collection-helpers';\n\n/**\n * The configuration for the Flatpickr plugin to set CSS classes specific to this design system.\n */\nexport interface DatePickerCSSClassPluginConfig {\n  /**\n   * The CSS class for the calendar dropdown.\n   */\n  classCalendarContainer: string;\n\n  /**\n   * The CSS class for the month navigator.\n   */\n  classMonth: string;\n\n  /**\n   * The CSS class for the container of the weekdays.\n   */\n  classWeekdays: string;\n\n  /**\n   * The CSS class for the container of the days.\n   */\n  classDays: string;\n\n  /**\n   * The CSS class applied to each weekdays.\n   */\n  classWeekday: string;\n\n  /**\n   * The CSS class applied to each days.\n   */\n  classDay: string;\n\n  /**\n   * The CSS class applied to the \"today\" highlight if there are any dates selected.\n   */\n  classNoBorder: string;\n\n  /**\n   * The CSS selector for Flatpickr's month navigator.\n   */\n  selectorFlatpickrMonth: string;\n\n  /**\n   * The CSS selector for Flatpickr's container of the weekdays.\n   */\n  selectorFlatpickrWeekdays: string;\n\n  /**\n   * The CSS selector for Flatpickr's container of the days.\n   */\n  selectorFlatpickrDays: string;\n\n  /**\n   * The CSS selector applied to Flatpickr's each weekdays.\n   */\n  selectorFlatpickrWeekday: string;\n\n  /**\n   * The CSS selector applied to Flatpickr's each days.\n   */\n  selectorFlatpickrDay: string;\n\n  /**\n   * The CSS class applied to Flatpickr's \"today\" highlight.\n   */\n  classFlatpickrToday: string;\n}\n\n/**\n * @param config Plugin configuration.\n * @returns A Flatpickr plugin to set CSS classes specific to this design system.\n */\nexport default (config: DatePickerCSSClassPluginConfig): Plugin =>\n  (fp: FlatpickrInstance) => {\n    /**\n     * Adds class names specific to our design system to calendar dropdown.\n     */\n    const ensureClassesInDatePicker = () => {\n      const { calendarContainer, selectedDates } = fp;\n      if (calendarContainer) {\n        const {\n          classCalendarContainer,\n          classMonth,\n          classWeekdays,\n          classDays,\n          classWeekday,\n          classDay,\n          classNoBorder,\n          selectorFlatpickrMonth,\n          selectorFlatpickrWeekdays,\n          selectorFlatpickrDays,\n          selectorFlatpickrWeekday,\n          selectorFlatpickrDay,\n          classFlatpickrToday,\n        } = config;\n        calendarContainer.classList.add(classCalendarContainer);\n        const month = calendarContainer.querySelector(selectorFlatpickrMonth);\n        if (month) {\n          month.classList.add(classMonth);\n        }\n        const weekdays = calendarContainer.querySelector(\n          selectorFlatpickrWeekdays\n        );\n        if (weekdays) {\n          weekdays.classList.add(classWeekdays);\n        }\n        const days = calendarContainer.querySelector(selectorFlatpickrDays);\n        if (days) {\n          days.classList.add(classDays);\n        }\n        forEach(\n          calendarContainer.querySelectorAll(selectorFlatpickrWeekday),\n          (item) => {\n            item.innerHTML = item.innerHTML.replace(/\\s+/g, '');\n            item.classList.add(classWeekday);\n          }\n        );\n        forEach(\n          calendarContainer.querySelectorAll(selectorFlatpickrDay),\n          (item) => {\n            item.classList.add(classDay);\n            if (\n              item.classList.contains(classFlatpickrToday) &&\n              // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- https://github.com/carbon-design-system/carbon/issues/20452\n              selectedDates!.length > 0\n            ) {\n              item.classList.add(classNoBorder);\n            } else if (\n              item.classList.contains(classFlatpickrToday) &&\n              // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- https://github.com/carbon-design-system/carbon/issues/20452\n              selectedDates!.length === 0\n            ) {\n              item.classList.remove(classNoBorder);\n            }\n          }\n        );\n      }\n    };\n\n    /**\n     * Registers this Flatpickr plugin.\n     */\n    const register = () => {\n      fp.loadedPlugins.push('carbonFlatpickrCSSClassPlugin');\n    };\n\n    return {\n      onMonthChange: ensureClassesInDatePicker,\n      onYearChange: ensureClassesInDatePicker,\n      onValueUpdate: ensureClassesInDatePicker,\n      onOpen: ensureClassesInDatePicker,\n      onReady: [register],\n    };\n  };\n"],"names":[],"mappings":";;;;;;;;;AAAA;;;;;AAKG;AA4EH;;;AAGG;AACH,qBAAe,CAAC,MAAsC,KACpD,CAAC,EAAqB,KAAI;AACxB;;AAEG;IACH,MAAM,yBAAyB,GAAG,MAAK;AACrC,QAAA,MAAM,EAAE,iBAAiB,EAAE,aAAa,EAAE,GAAG,EAAE;QAC/C,IAAI,iBAAiB,EAAE;AACrB,YAAA,MAAM,EACJ,sBAAsB,EACtB,UAAU,EACV,aAAa,EACb,SAAS,EACT,YAAY,EACZ,QAAQ,EACR,aAAa,EACb,sBAAsB,EACtB,yBAAyB,EACzB,qBAAqB,EACrB,wBAAwB,EACxB,oBAAoB,EACpB,mBAAmB,GACpB,GAAG,MAAM;AACV,YAAA,iBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAsB,CAAC;YACvD,MAAM,KAAK,GAAG,iBAAiB,CAAC,aAAa,CAAC,sBAAsB,CAAC;YACrE,IAAI,KAAK,EAAE;AACT,gBAAA,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC;;YAEjC,MAAM,QAAQ,GAAG,iBAAiB,CAAC,aAAa,CAC9C,yBAAyB,CAC1B;YACD,IAAI,QAAQ,EAAE;AACZ,gBAAA,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC;;YAEvC,MAAM,IAAI,GAAG,iBAAiB,CAAC,aAAa,CAAC,qBAAqB,CAAC;YACnE,IAAI,IAAI,EAAE;AACR,gBAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC;;YAE/B,OAAO,CACL,iBAAiB,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,EAC5D,CAAC,IAAI,KAAI;AACP,gBAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;AACnD,gBAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC;AAClC,aAAC,CACF;YACD,OAAO,CACL,iBAAiB,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,EACxD,CAAC,IAAI,KAAI;AACP,gBAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC;AAC5B,gBAAA,IACE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,mBAAmB,CAAC;;AAE5C,oBAAA,aAAc,CAAC,MAAM,GAAG,CAAC,EACzB;AACA,oBAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC;;AAC5B,qBAAA,IACL,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,mBAAmB,CAAC;;AAE5C,oBAAA,aAAc,CAAC,MAAM,KAAK,CAAC,EAC3B;AACA,oBAAA,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC;;AAExC,aAAC,CACF;;AAEL,KAAC;AAED;;AAEG;IACH,MAAM,QAAQ,GAAG,MAAK;AACpB,QAAA,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,+BAA+B,CAAC;AACxD,KAAC;IAED,OAAO;AACL,QAAA,aAAa,EAAE,yBAAyB;AACxC,QAAA,YAAY,EAAE,yBAAyB;AACvC,QAAA,aAAa,EAAE,yBAAyB;AACxC,QAAA,MAAM,EAAE,yBAAyB;QACjC,OAAO,EAAE,CAAC,QAAQ,CAAC;KACpB;AACH,CAAC;;;;"}