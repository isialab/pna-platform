{"version":3,"file":"toggle.js","sources":["../../../src/components/toggle/toggle.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2019, 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { classMap } from 'lit/directives/class-map.js';\nimport { html } from 'lit';\nimport { property, query } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { prefix } from '../../globals/settings';\nimport CDSCheckbox from '../checkbox/checkbox';\nimport { TOGGLE_SIZE } from './defs';\nimport styles from './toggle.scss?lit';\nimport HostListenerMixin from '../../globals/mixins/host-listener';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\nexport { TOGGLE_SIZE };\n\n/**\n * Basic toggle.\n *\n * @element cds-custom-toggle\n * @slot label-text - The label text.\n * @slot checked-text - The text for the checked state.\n * @slot unchecked-text - The text for the unchecked state.\n * @fires cds-custom-toggle-changed - The custom event fired after this changebox changes its checked state.\n */\n@customElement(`${prefix}-toggle`)\nclass CDSToggle extends HostListenerMixin(CDSCheckbox) {\n  @query('button')\n  protected _checkboxNode!: HTMLInputElement;\n\n  /**\n   * Handles `click` event on the `<button>` in the shadow DOM.\n   */\n  protected _handleChange() {\n    const { checked } = this._checkboxNode;\n    if (this.disabled || this.readOnly) {\n      return;\n    }\n    this.toggled = !checked;\n    const { eventChange } = this.constructor as typeof CDSToggle;\n    this.dispatchEvent(\n      new CustomEvent(eventChange, {\n        bubbles: true,\n        composed: true,\n        detail: {\n          checked: this.toggled, // TODO: remove in v12\n          toggled: this.toggled,\n        },\n      })\n    );\n  }\n\n  protected _renderCheckmark() {\n    if (this.size !== TOGGLE_SIZE.SMALL || this.readOnly == true) {\n      return undefined;\n    }\n    return html`\n      <svg\n        class=\"${prefix}--toggle__check\"\n        width=\"6px\"\n        height=\"5px\"\n        viewBox=\"0 0 6 5\">\n        <path d=\"M2.2 2.7L5 0 6 1 2.2 5 0 2.7 1 1.5z\" />\n      </svg>\n    `;\n  }\n\n  // TODO: remove in v12\n  /**\n   * @deprecated Use `toggled` instead.\n   * The `checked` attribute will be removed in the next major version.\n   */\n  declare checked: boolean;\n  // TODO: remove in v12\n  /**\n   *\n   * **Deprecated:** Use `toggled` instead.\n   * The `checked` attribute will be removed in the next major version.\n   */\n  @property({ type: Boolean, attribute: 'checked', reflect: true })\n  get _checkedAttributeAlias() {\n    return this.toggled;\n  }\n  set _checkedAttributeAlias(v: boolean) {\n    this.toggled = v;\n  }\n\n  // TODO: remove get() and set() in v12\n  /**\n   * Specify whether the control is toggled\n   */\n  @property({ type: Boolean, reflect: true })\n  get toggled(): boolean {\n    return this.checked;\n  }\n  set toggled(v: boolean) {\n    const prev = this.checked;\n    const next = v;\n    if (prev === next) return;\n    this.checked = v;\n\n    this.requestUpdate('toggled', prev);\n    this.requestUpdate('_checkedAttributeAlias');\n  }\n  /**\n   * Specify another element's id to be used as the label for this toggle\n   */\n  @property({ type: String, attribute: 'aria-labelledby' })\n  ariaLabelledby?: string;\n\n  // TODO: swap value with labelB in v12 to match React\n  /**\n   * Specify the label for the \"on\" position\n   */\n  @property({ attribute: 'label-a' })\n  labelA = 'On';\n\n  /**\n   * Hide label text.\n   */\n  @property({ reflect: true, type: Boolean })\n  hideLabel = false;\n\n  /**\n   * Read only boolean.\n   */\n  @property({ reflect: true, attribute: 'read-only', type: Boolean })\n  readOnly = false;\n\n  /**\n   * Toggle size.\n   */\n  @property({ reflect: true })\n  size = TOGGLE_SIZE.REGULAR;\n\n  // TODO: swap value with labelA in v12 to match React\n  /**\n   * Specify the label for the \"off\" position\n   */\n  @property({ attribute: 'label-b' })\n  labelB = 'Off';\n\n  /**\n   * Private references of external <label> elements that are\n   * `for=\"this-toggle-element-id\"`\n   */\n  private _externalLabels: HTMLLabelElement[] = [];\n\n  /**\n   * Handles `click` on external `<label>`\n   */\n  private _onExternalLabelClick = () => {\n    this._checkboxNode?.focus();\n    this._handleChange();\n  };\n\n  /**\n   * Finds external toggle `<label>`s and attaches handlers.\n   */\n  private _attachExternalLabels() {\n    const doc = this.ownerDocument || document;\n\n    const found = this.id\n      ? [...doc.querySelectorAll<HTMLLabelElement>(`label[for=\"${this.id}\"]`)]\n      : [];\n\n    this._externalLabels = Array.from(new Set(found));\n    this._externalLabels.forEach((lbl) => {\n      lbl.addEventListener('click', this._onExternalLabelClick);\n    });\n  }\n\n  connectedCallback() {\n    super.connectedCallback?.();\n    this._attachExternalLabels();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback?.();\n    this._externalLabels.forEach((lbl) =>\n      lbl.removeEventListener('click', this._onExternalLabelClick)\n    );\n  }\n\n  render() {\n    const {\n      toggled,\n      disabled,\n      labelText,\n      hideLabel,\n      id,\n      name,\n      size,\n      labelA,\n      labelB,\n      value,\n      _handleChange: handleChange,\n    } = this;\n    const inputClasses = classMap({\n      [`${prefix}--toggle__appearance`]: true,\n      [`${prefix}--toggle__appearance--${size}`]: size,\n    });\n    const toggleClasses = classMap({\n      [`${prefix}--toggle__switch`]: true,\n      [`${prefix}--toggle__switch--checked`]: toggled,\n    });\n\n    const labelTextClasses = classMap({\n      [`${prefix}--toggle__label-text`]: labelText,\n      [`${prefix}--visually-hidden`]: hideLabel,\n    });\n\n    let stateText = '';\n\n    if (hideLabel) {\n      stateText = labelText || '';\n    } else {\n      stateText = toggled ? labelA : labelB;\n    }\n\n    const labelId = id ? `${id}_label` : undefined;\n\n    const hasLabelText = (this.labelText ?? '') !== '';\n\n    const ariaLabelledby = this.ariaLabelledby ?? (hasLabelText && labelId);\n\n    return html`\n      <button\n        class=\"${prefix}--toggle__button\"\n        role=\"switch\"\n        type=\"button\"\n        aria-checked=${toggled}\n        aria-labelledby=${ifDefined(ariaLabelledby)}\n        .checked=${toggled}\n        name=\"${ifDefined(name)}\"\n        value=\"${ifDefined(value)}\"\n        ?disabled=${disabled}\n        id=\"${id}\"\n        @click=${handleChange}></button>\n      <label for=\"${id}\" class=\"${prefix}--toggle__label\">\n        ${labelText\n          ? html`<span class=\"${labelTextClasses}\">${labelText}</span>`\n          : null}\n        <div class=\"${inputClasses}\">\n          <div class=\"${toggleClasses}\">${this._renderCheckmark()}</div>\n          <span class=\"${prefix}--toggle__text\" aria-hidden=\"true\"\n            >${stateText}</span\n          >\n        </div>\n      </label>\n    `;\n  }\n\n  /**\n   * The name of the custom event fired after this changebox changes its toggled state.\n   */\n  static get eventChange() {\n    return `${prefix}-toggle-changed`;\n  }\n\n  static styles = styles;\n}\n\nexport default CDSToggle;\n"],"names":["customElement"],"mappings":"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"}