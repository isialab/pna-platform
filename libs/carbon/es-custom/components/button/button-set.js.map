{"version":3,"file":"button-set.js","sources":["../../../src/components/button/button-set.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2020, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { classMap } from 'lit/directives/class-map.js';\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { BUTTON_KIND } from './defs';\nimport styles from './button.scss?lit';\nimport { prefix } from '../../globals/settings';\nimport CDSButtonSetBase from './button-set-base';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\n/**\n * Button set.\n *\n * @element cds-custom-button-set\n */\n@customElement(`${prefix}-button-set`)\nclass CDSButtonSet extends CDSButtonSetBase {\n  /**\n   * `true` if the buttons should be stacked. Only applies to the button-set variant.\n   */\n  @property({ type: Boolean, reflect: true })\n  stacked = false;\n\n  /**\n   * Handler for @slotchange, set the first cds-custom-button to kind secondary and primary for the remaining ones\n   *\n   * @private\n   */\n  protected _handleSlotChange(event: Event) {\n    const childItems = (event.target as HTMLSlotElement)\n      .assignedNodes()\n      .filter((elem) =>\n        (elem as HTMLElement).matches !== undefined\n          ? (elem as HTMLElement).matches(\n              (this.constructor as typeof CDSButtonSet).selectorItem\n            )\n          : false\n      );\n\n    childItems.forEach((elem, index) => {\n      (elem as HTMLElement).setAttribute(\n        'kind',\n        index === 0 ? BUTTON_KIND.SECONDARY : BUTTON_KIND.PRIMARY\n      );\n    });\n\n    const update = new CustomEvent(`${prefix}-btn-set-update`, {\n      bubbles: true,\n      cancelable: true,\n      composed: true,\n    });\n\n    this.dispatchEvent(update);\n  }\n\n  /**\n   * When a button within a button-set is focused, hide the margin on both sides\n   * of the focused button, by applying the appropriate styles to its sibling\n   *\n   * @private\n   */\n  private _hideSiblingMargin = () => {\n    const slot = this.shadowRoot?.querySelector('slot');\n    if (!slot) return;\n    const items = slot\n      .assignedElements()\n      .filter(\n        (el) => el.tagName.toLowerCase() === `${prefix}-button`\n      ) as HTMLElement[];\n\n    const focusedIndex = items.findIndex((el) => el.matches(':focus-within'));\n\n    items.forEach((el, idx) => {\n      const shouldHide =\n        focusedIndex >= 0 && (idx === focusedIndex || idx === focusedIndex + 1);\n      el.toggleAttribute('hide-margin', shouldHide);\n    });\n  };\n\n  connectedCallback() {\n    super.connectedCallback?.();\n    this.addEventListener('focusin', this._hideSiblingMargin);\n    this.addEventListener('focusout', this._hideSiblingMargin);\n  }\n\n  render() {\n    const { stacked } = this;\n    const defaultClasses = {\n      [`${prefix}--btn-set--stacked`]: stacked,\n      [`${prefix}--btn-set`]: true,\n    };\n    const classes = classMap(defaultClasses);\n\n    return html`<slot class=\"${classes} @slotchange=\"${this._handleSlotChange}\"></slot>`;\n  }\n  /**\n   * A selector that will return the child items.\n   */\n  static get selectorItem() {\n    return `${prefix}-button`;\n  }\n\n  static styles = styles;\n}\n\nexport default CDSButtonSet;\n"],"names":["styles","customElement"],"mappings":"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"}