{"version":3,"file":"progress-bar.js","sources":["../../../src/components/progress-bar/progress-bar.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2019, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { LitElement, html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\nimport { classMap } from 'lit/directives/class-map.js';\nimport {\n  PROGRESS_BAR_SIZE,\n  PROGRESS_BAR_STATUS,\n  PROGRESS_BAR_TYPE,\n} from './defs';\nimport { prefix } from '../../globals/settings';\nimport ErrorFilled16 from '@carbon/icons/es/error--filled/16.js';\nimport CheckmarkFilled16 from '@carbon/icons/es/checkmark--filled/16.js';\nimport { iconLoader } from '../../globals/internal/icon-loader';\nimport styles from './progress-bar.scss?lit';\n\nexport { PROGRESS_BAR_SIZE, PROGRESS_BAR_STATUS, PROGRESS_BAR_TYPE };\n\n/**\n * Progress bar.\n *\n * @element cds-custom-progress-bar\n */\n@customElement(`${prefix}-progress-bar`)\nclass CDSProgressBar extends LitElement {\n  /**\n   * The current progress as a textual representation.\n   */\n  @property({ type: String, attribute: 'helper-text', reflect: true })\n  helperText;\n\n  /**\n   * Whether the label should be visually hidden.\n   */\n  @property({ type: Boolean, attribute: 'hide-label', reflect: true })\n  hideLabel;\n\n  /**\n   * A label describing the progress bar.\n   */\n  @property({ type: String })\n  label;\n\n  /**\n   * The maximum value.\n   */\n  @property({ type: Number, reflect: true })\n  max = 100;\n\n  /**\n   * Specify the size of the ProgressBar.\n   */\n  @property({ type: String, reflect: true })\n  size = PROGRESS_BAR_SIZE.BIG;\n\n  /**\n   * Specify the status.\n   */\n  @property({ type: String, reflect: true })\n  status = PROGRESS_BAR_STATUS.ACTIVE;\n\n  /**\n   * Defines the alignment variant of the progress bar.\n   */\n  @property({ type: String, reflect: true })\n  type = PROGRESS_BAR_TYPE.DEFAULT;\n\n  /**\n   * The current value.\n   */\n  @property({ type: Number, reflect: true })\n  value;\n\n  protected get _cappedValue() {\n    const { value, max, status } = this;\n\n    let cappedValue = value;\n    if (cappedValue > max) {\n      cappedValue = max;\n    }\n    if (cappedValue < 0) {\n      cappedValue = 0;\n    }\n    if (status === PROGRESS_BAR_STATUS.ERROR) {\n      cappedValue = 0;\n    } else if (status === PROGRESS_BAR_STATUS.FINISHED) {\n      cappedValue = max;\n    }\n\n    return cappedValue;\n  }\n\n  updated(changedProperties) {\n    if (\n      changedProperties.has('value') ||\n      changedProperties.has('max') ||\n      changedProperties.has('status')\n    ) {\n      const { _cappedValue: cappedValue, max, status } = this;\n\n      const percentage: number = cappedValue / max;\n\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- https://github.com/carbon-design-system/carbon/issues/20452\n      const bar = this.shadowRoot!.querySelector(\n        `.${prefix}--progress-bar__bar`\n      ) as HTMLElement;\n\n      if (\n        status != PROGRESS_BAR_STATUS.ERROR &&\n        status != PROGRESS_BAR_STATUS.FINISHED\n      ) {\n        bar.style.transform = `scaleX(${percentage})`;\n      } else {\n        bar.style.transform = 'none';\n      }\n    }\n  }\n\n  render() {\n    const {\n      _cappedValue: cappedValue,\n      helperText,\n      hideLabel,\n      label,\n      max,\n      size,\n      status,\n      type,\n      value,\n    } = this;\n\n    const isFinished = status === PROGRESS_BAR_STATUS.FINISHED;\n    const isError = status === PROGRESS_BAR_STATUS.ERROR;\n\n    const indeterminate =\n      !isFinished && !isError && (value === null || value === undefined);\n\n    let statusIcon: ReturnType<typeof iconLoader> | null = null;\n\n    if (isError) {\n      statusIcon = iconLoader(ErrorFilled16, {\n        class: `${prefix}--progress-bar__status-icon`,\n      });\n    } else if (isFinished) {\n      statusIcon = iconLoader(CheckmarkFilled16, {\n        class: `${prefix}--progress-bar__status-icon`,\n      });\n    }\n\n    const wrapperClasses = classMap({\n      [`${prefix}--progress-bar`]: true,\n      [`${prefix}--progress-bar--${size}`]: true,\n      [`${prefix}--progress-bar--${type}`]: true,\n      [`${prefix}--progress-bar--indeterminate`]: indeterminate,\n      [`${prefix}--progress-bar--finished`]: isFinished,\n      [`${prefix}--progress-bar--error`]: isError,\n    });\n\n    const labelClasses = classMap({\n      [`${prefix}--progress-bar__label`]: true,\n      [`${prefix}--visually-hidden`]: hideLabel,\n    });\n\n    return html` <div class=\"${wrapperClasses}\">\n      <div class=\"${labelClasses}\">\n        <span class=\"${prefix}--progress-bar__label-text\">${label}</span>\n        ${statusIcon}\n      </div>\n      <div\n        class=\"${prefix}--progress-bar__track\"\n        role=\"progressbar\"\n        aria-busy=\"${!isFinished}\"\n        aria-invalid=\"${isError}\"\n        aria-valuemin=\"${!indeterminate ? 0 : null}\"\n        aria-valuemax=\"${!indeterminate ? max : null}\"\n        aria-valuenow=\"${!indeterminate ? cappedValue : null}\">\n        <div class=\"${prefix}--progress-bar__bar\"></div>\n      </div>\n      ${helperText\n        ? html`<div class=\"${prefix}--progress-bar__helper-text\">\n            ${helperText}\n            <div class=\"${prefix}--visually-hidden\" aria-live=\"polite\">\n              ${isFinished ? 'Done' : 'Loading'}\n            </div>\n          </div>`\n        : null}\n    </div>`;\n  }\n\n  static styles = styles;\n}\n\nexport default CDSProgressBar;\n"],"names":["customElement"],"mappings":"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"}