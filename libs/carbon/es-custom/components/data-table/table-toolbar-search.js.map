{"version":3,"file":"table-toolbar-search.js","sources":["../../../src/components/data-table/table-toolbar-search.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2019, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { classMap } from 'lit/directives/class-map.js';\nimport { LitElement, html } from 'lit';\nimport { property, query } from 'lit/decorators.js';\nimport { prefix } from '../../globals/settings';\nimport HostListenerMixin from '../../globals/mixins/host-listener';\nimport HostListener from '../../globals/decorators/host-listener';\nimport { INPUT_SIZE } from '../text-input/text-input';\nimport CDSSearch from '../search/search';\nimport styles from './data-table.scss?lit';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\n/**\n * Table toolbar search.\n *\n * @element cds-custom-table-toolbar-search\n * @fires cds-custom-search-input - The custom event fired after the search content is changed upon a user gesture.\n */\n@customElement(`${prefix}-table-toolbar-search`)\nclass CDSTableToolbarSearch extends HostListenerMixin(CDSSearch) {\n  @query('input')\n  private _inputNode!: HTMLInputElement;\n\n  /**\n   * Handles user-initiated gestures for expanding the search box.\n   */\n  private async _handleUserInitiatedExpand() {\n    this.expanded = true;\n    await this.updateComplete;\n    const { _inputNode: inputNode } = this;\n    inputNode?.focus();\n  }\n\n  /**\n   * Handles `focus` event handler on this element.\n   */\n  @HostListener('focusin')\n  // @ts-expect-error: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleFocusIn() {\n    this._handleUserInitiatedExpand();\n  }\n\n  /**\n   * Handles `blur` event handler on this element.\n   *\n   * @param event The event.\n   */\n  @HostListener('focusout')\n  // @ts-expect-error: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleFocusOut(event: FocusEvent) {\n    if (\n      !this.contains(event.relatedTarget as Node) &&\n      !this.value &&\n      !this.persistent\n    ) {\n      this.expanded = false;\n    }\n  }\n\n  /**\n   * Handles `click` event handler on the search box.\n   */\n  private _handleSearchClick() {\n    this._handleUserInitiatedExpand();\n  }\n\n  /**\n   * `true` if the search box should be expanded.\n   */\n  @property({ type: Boolean, reflect: true })\n  expanded = false;\n\n  /**\n   * `true` if the search box should be always be open.\n   */\n  @property({ type: Boolean, reflect: true })\n  persistent = false;\n\n  /**\n   * The search box size.\n   */\n  @property({ reflect: true })\n  size = INPUT_SIZE.LARGE;\n\n  connectedCallback() {\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'search');\n    }\n    super.connectedCallback();\n  }\n\n  render() {\n    const result = super.render();\n    const {\n      persistent,\n      expanded,\n      size,\n      _handleSearchClick: handleSearchClick,\n    } = this;\n    const classes = classMap({\n      [`${prefix}--search`]: true,\n      [`${prefix}--search--${size}`]: size,\n    });\n    if (persistent) {\n      this.expanded = true;\n    }\n    return html`\n      <div\n        class=\"${classes}\"\n        tabindex=\"${expanded ? '-1' : '0'}\"\n        @click=\"${handleSearchClick}\">\n        ${result}\n      </div>\n    `;\n  }\n\n  /**\n   * The name of the custom event fired after the search content is changed upon a user gesture.\n   */\n  static get eventInput() {\n    // The code uses on in `<cds-custom-search>`, but definition is done also here for React event generation\n    return `${prefix}-search-input`;\n  }\n\n  static shadowRootOptions = {\n    ...LitElement.shadowRootOptions,\n    delegatesFocus: true,\n  };\n  static styles = styles;\n}\n\nexport default CDSTableToolbarSearch;\n"],"names":["customElement"],"mappings":"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"}