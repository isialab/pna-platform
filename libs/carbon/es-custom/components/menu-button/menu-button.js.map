{"version":3,"file":"menu-button.js","sources":["../../../src/components/menu-button/menu-button.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2025, 2025\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { LitElement, html } from 'lit';\nimport { property, query } from 'lit/decorators.js';\nimport { prefix } from '../../globals/settings';\nimport HostListener from '../../globals/decorators/host-listener';\nimport HostListenerMixin from '../../globals/mixins/host-listener';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\nimport styles from './menu-button.scss?lit';\nimport '../button/index';\nimport '../menu/index';\nimport ChevronDown16 from '@carbon/icons/es/chevron--down/16.js';\nimport { iconLoader } from '../../globals/internal/icon-loader';\nimport { POPOVER_ALIGNMENT } from '../popover/defs';\nimport CDSMenu from '../menu/menu';\nimport CDSButton from '../button/button';\nimport { MENU_BUTTON_KIND, MENU_BUTTON_SIZE } from './defs';\nimport { MENU_BACKGROUND_TOKEN } from '../menu/defs';\nimport FloatingUIController from '../../globals/controllers/floating-controller';\n\nexport { MENU_BUTTON_KIND, MENU_BUTTON_SIZE };\n\n/**\n * Menu button.\n * @element cds-custom-menu-button\n */\n@customElement(`${prefix}-menu-button`)\nclass CDSMenuButton extends HostListenerMixin(LitElement) {\n  private _menuController = new FloatingUIController(this);\n\n  @query(`${prefix}-button`)\n  _triggerNode!: CDSButton;\n\n  @query(`${prefix}-menu`)\n  _menuNode!: CDSMenu;\n\n  @property({ type: Boolean, reflect: true })\n  private _open = false;\n\n  /**\n   * Specify whether the MenuButton should be disabled, or not.\n   */\n  @property({ type: Boolean, reflect: true })\n  disabled;\n\n  /**\n   * Specify the type of button to be used as the base for the trigger button.\n   */\n  @property({ type: MENU_BUTTON_KIND, reflect: true })\n  kind = MENU_BUTTON_KIND.PRIMARY;\n\n  /**\n   * Provide the label to be rendered on the trigger button.\n   */ @property({ type: String })\n  label;\n\n  /**\n   * Experimental property. Specify how the menu should align with the button element\n   */\n  @property({ reflect: true, type: String, attribute: 'menu-alignment' })\n  menuAlignment = POPOVER_ALIGNMENT.BOTTOM;\n\n  /**\n   * Specify whether the menu should have a border.\n   */\n  @property({ type: Boolean, reflect: true, attribute: 'menu-border' })\n  menuBorder = false;\n\n  /**\n   * Specify the background token to use for the menu. Default is 'layer'.\n   */\n  @property({ type: String, reflect: true, attribute: 'menu-background-token' })\n  menuBackgroundToken = MENU_BACKGROUND_TOKEN.LAYER;\n\n  /**\n   * Specify the size of the button and menu.\n   */\n  @property({ type: MENU_BUTTON_SIZE, reflect: true })\n  size = MENU_BUTTON_SIZE.LARGE;\n\n  /**\n   * Specify the tabIndex of the button.\n   */\n  @property({ type: Number, attribute: 'tab-index', reflect: true })\n  tabIndex = 0;\n\n  @HostListener('click')\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment -- https://github.com/carbon-design-system/carbon/issues/20452\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleClick = (event: Event) => {\n    const path = event.composedPath();\n    if (path.includes(this._triggerNode)) {\n      this._open = !this._open;\n    } else if (this._open) {\n      this._open = false;\n    }\n  };\n\n  @HostListener('focusout')\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment -- https://github.com/carbon-design-system/carbon/issues/20452\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleBlur = ({ relatedTarget }: FocusEvent) => {\n    // Close the menu if the focus moves outside the menu button or menu\n    if (!this.contains(relatedTarget as Node)) {\n      this._open = false;\n    }\n  };\n\n  updated(changedProperties) {\n    const menu = this.querySelector(`${prefix}-menu`) as CDSMenu;\n\n    if (\n      changedProperties.has('_open') ||\n      changedProperties.has('menuAlignment')\n    ) {\n      this.updateComplete.then(() => {\n        const styleElement = menu.shadowRoot?.querySelector(\n          `.${prefix}--menu`\n        ) as HTMLElement;\n\n        menu.open = this._open;\n\n        this._menuController.setPlacement({\n          trigger: this._triggerNode,\n          target: menu,\n          alignment: this.menuAlignment,\n          styleElement,\n          matchWidth: true,\n          open: this._open,\n        });\n      });\n    }\n\n    if (changedProperties.has('size')) {\n      menu.setAttribute('size', this.size);\n    }\n\n    if (changedProperties.has('menuBorder')) {\n      menu.toggleAttribute('border', this.menuBorder);\n    }\n\n    if (changedProperties.has('menuBackgroundToken')) {\n      menu.backgroundToken = this.menuBackgroundToken;\n    }\n  }\n\n  render() {\n    const { kind, size, disabled, tabIndex, label } = this;\n    return html`\n      <cds-custom-button\n        kind=${kind}\n        size=${size}\n        ?disabled=${disabled}\n        tab-index=${tabIndex}>\n        ${label} ${iconLoader(ChevronDown16, { slot: 'icon' })}\n      </cds-custom-button>\n      <slot></slot>\n    `;\n  }\n\n  static styles = styles;\n}\n\nexport default CDSMenuButton;\n"],"names":["FloatingUIController","customElement"],"mappings":"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"}